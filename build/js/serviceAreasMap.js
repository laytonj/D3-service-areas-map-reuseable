"use strict";var config={colors:{mapDefault:{style1:"#585858",style2:"#007ABD"}},data:{none:{dropdownName:"None"},data_pctOfPopEligible:{dropdownName:"Percent LSC eligible",tooltipName:"Percent eligible for LSC services",legendName:"Percent eligible for LSC services",type:"percent",format:",.0%",domainMinForTooltip:0,domainMaxForTooltip:null,diverging:!1,colorThresholds:{SA:[.15,.2,.25,.3],ST:[.15,.2,.25,.3]},nationalValue:{SA:.1785,ST:.17765},nationalValueType:"median",aboutDataHtml:"<span style='font-weight:bold'>This map shows the percent of people who are eligible for LSC services, having income of 125% of the federal poverty line or below.</span> The data are from the U.S. Census Bureau's 2017 American Community Survey 1-year estimates. LSC receives this data disaggregated at the LSC Service Area and State summary levels. LSC Service Area summary level data are unpublished, special tabulations; state summary level information are published by the U.S. Census Bureau and are available via American FactFinder. For U.S. territories besides Puerto Rico, the data are from the 2010 Decennial Census, tables PBG83 or PBG77. Note that the eligibility figures used for Micronesia are an underestimate, as they reflect 100% of poverty."},data_pctChangePopEligible:{dropdownName:"Change in eligible pop",tooltipName:"Percent change in eligible population, '16-'17",legendName:"Percent change in eligible population, 2016 to 2017",type:"percent",format:",.0%",domainMinForTooltip:null,domainMaxForTooltip:null,diverging:!0,colorThresholds:{SA:[-.1,-.05,0,.05],ST:[-.1,-.05,0,.05]},nationalValue:{SA:-.0285,ST:-.0256},nationalValueType:"median",aboutDataHtml:"People with income of up to 125% of the official federal poverty line are eligible for LSC services. <span style='font-weight:bold'>This map shows the percent change from 2016 to 2017 in the number of income-eligible people.</span> The data are from the U.S. Census Bureau's 2016 and 2017 American Community Survey 1-year estimates. LSC receives this data disaggregated at the LSC Service Area and State summary levels. LSC Service Area summary level data are unpublished, special tabulations; state summary level information are published by the U.S. Census Bureau and are available via American FactFinder. For U.S. territories besides Puerto Rico, the data are from the 2010 Decennial Census, tables PBG83 or PBG77."},data_casesPer10K:{dropdownName:"Cases per 10K poverty",tooltipName:"Cases closed per 10K people in poverty",legendName:"Number of cases closed per 10,000 people in poverty",type:"number",format:",.0f",domainMinForTooltip:0,domainMaxForTooltip:null,diverging:!1,colorThresholds:{SA:[100,150,200,250],ST:[100,150,200,250]},nationalValue:{SA:169.55,ST:158.05},nationalValueType:"median",aboutDataHtml:"<span style='font-weight:bold'>This map shows the number of Basic Field Grant cases closed per 10,000 people in poverty.</span> Case data are from the 2018 Grantee Activity Reports submitted to LSC from each grantee. Poverty data are from the U.S. Census Bureau's 2017 American Community Survey 1-year estimates. LSC receives this data disaggregated at the LSC Service Area and State summary levels. LSC Service Area summary level data are unpublished, special tabulations; state summary level information are published by the U.S. Census Bureau and are available via American FactFinder. For U.S. territories besides Puerto Rico, poverty data are from the 2010 Decennial Census, tables PBG83 or PBG77."}}};!function(){function t(t,e,a,r,n,o,s,l,i){var G=!(0<arguments.length&&void 0!==t)||t,L=!(1<arguments.length&&void 0!==e)||e,B=2<arguments.length&&void 0!==a?a:0,c=!(3<arguments.length&&void 0!==r)||r,C=4<arguments.length&&void 0!==n?n:1,D=!(5<arguments.length&&void 0!==o)||o,u=!(6<arguments.length&&void 0!==s)||s,M=7<arguments.length&&void 0!==l&&l,I=8<arguments.length&&void 0!==i&&i;C="style"+String(C);var N=d3.select("#map");N.attr("class",C);var g=35;!0===G&&(g+=35);var P=parseInt(N.style("width")),k=!0===G?.75*P:.75*P-g,V=N.append("svg").style("overflow","hidden").attr("width",P).attr("height",k),d=V.append("g").attr("id","instructionsG").attr("transform","translate(10, ".concat(k-30,")"));d.append("text").text("".concat(!1===D?"Click a state or service area to see its profile.":"Mouse over an area for more info.")).style("visibility",function(){return 745<P?"visible":"hidden"}).attr("class","instructions ".concat(!1===D?"instructions-bold":"")),d.append("text").text("Drag to pan. Scroll to zoom.").attr("class","instructions").style("visibility",function(){return 745<P?"visible":"hidden"}).attr("transform","translate(0,20)");var p=V.append("g").attr("id","mapZoomSensor"),f=p.append("rect").attr("id","mapZoomRect").attr("class",C).attr("width",P).attr("height",k-g).attr("transform","translate(0,"+g+")"),_=p.append("g").attr("id","mapsG").attr("height",k-g).attr("transform","translate(0,"+g+")"),m=d3.geoAlbersUsaTerritories().translate([P/1.91,(k-g)/2.15]).scale([1.225*P]),F=d3.geoPath().projection(m),y=d3.zoom().scaleExtent([1,20]).translateExtent([[-P/2,-k/2],[1.5*P,1.5*k]]).extent([[0,0],[P,k]]).on("zoom",function(){_.selectAll("path").attr("transform",d3.event.transform),_.selectAll("rect").attr("transform",d3.event.transform),ct.style("pointer-events","auto").transition().duration(1e3).style("opacity",1),kt(),_.selectAll("path").style("pointer-events","none")}).on("end",function(){_.selectAll("path").style("pointer-events","auto"),1==d3.event.transform.k&&0==d3.event.transform.x&&0==d3.event.transform.y&&ct.style("pointer-events","none").transition().duration(1e3).style("opacity",0)});p.call(y);_.append("g").attr("id","baseG");var h,R=_.append("g").attr("id","statesG"),O=_.append("g").attr("id","serviceAreasG");!0===c?h=["MP","PR","VI","AS"]:!1===c&&(h=["GU","MP","PR","VI","AS"]),_.selectAll(".territoryBox").data(h).enter().append("rect").attr("class","territoryBox "+C).attr("id",function(t){return"territoryBox"+t}),d3.select("#territoryBoxMP").attr("height","".concat(!0===c?.22*k:.189*k)).attr("width",.05*P).attr("x",.004*P).attr("y","".concat(!0===G?.335*k:.365*k)),!1===c&&d3.select("#territoryBoxGU").attr("height",.032*(k-g)).attr("width",.05*P).attr("x",.004*P).attr("y","".concat(!0===G?.525*k:.555*k)),d3.select("#territoryBoxAS").attr("height",.04*(k-g)).attr("width",.083*P).attr("x",.004*P).attr("y","".concat(!0===G?.56*k:.59*k)),d3.select("#territoryBoxPR").attr("height",.05*(k-g)).attr("width",.064*P).attr("x",.905*P).attr("y","".concat(!0===G?.75*k:.795*k)),d3.select("#territoryBoxVI").attr("height",.05*(k-g)).attr("width",.025*P).attr("x",.97*P).attr("y","".concat(!0===G?.75*k:.795*k));var v=V.append("defs").append("filter").attr("id","drop-shadow").attr("height","130%");v.append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation",1.8).attr("result","blur"),v.append("feOffset").attr("in","blur").attr("dx",1.8).attr("dy",1.8).attr("result","offsetBlur");var A=v.append("feMerge");A.append("feMergeNode").attr("in","offsetBlur"),A.append("feMergeNode").attr("in","SourceGraphic");var E=!0===L?"SA":"ST",H=150,j=10;if(!0===G)var b=745<P?25:0,T=g/2-5,x=T+23,S=15,w=30,U=745<P?b+85:0,z=($=34)+20,Z=(tt=745<P?U+60:20)+350,K=23,W=g/2+8,Y=Z+45,q=tt+150,J=Y+75,X=830<P?J+145:J+12,Q=830<P?X:J+16;else if(!1===G){var $,tt=P/2-H-5;z=($=4)+20}var et=$+27+2,at=V.append("g").attr("id","menuBarG");at.append("rect").attr("id","menuBarRect").attr("class",C).attr("width",P).attr("height",g);if(1==G){at.append("text").attr("class","selectLayerHeader "+C).text("Select").attr("visibility",function(){return 745<P?"visible":"hidden"}).attr("transform","translate("+b+","+T+")"),at.append("text").attr("class","selectLayerHeader "+C).text("Layers").attr("visibility",function(){return 745<P?"visible":"hidden"}).attr("transform","translate("+b+","+x+")");at.append("path").attr("d","M 0 0 L ".concat(S," ").concat(w/2," L 0 ").concat(w," Z")).attr("id","menuTriangle1").attr("class","menuTriangle "+C).attr("visibility",function(){return 745<P?"visible":"hidden"}).attr("transform","translate(".concat(U,", ").concat(g/2-w/2,")")),at.append("path").attr("d","M 0 0 L ".concat(S," ").concat(w/2," L 0 ").concat(w," Z")).attr("id","menuTriangle2").attr("class","menuTriangle style "+C).attr("transform","translate(".concat(Z,", ").concat(g/2-w/2,")"));at.append("text").attr("class","menuBarText "+C).text(function(){return 745<P?"Geography":"Geography Layer"}).attr("transform","translate("+q+","+K+")")}var rt,nt=at.append("g").attr("class","toggle").attr("id","serviceAreasToggleG").on("mouseover",function(){d3.select("#serviceAreasToggle").classed("toggleHovered",!0)}).on("mouseout",function(){d3.select("#serviceAreasToggle").classed("toggleHovered",!1)}),ot=(nt.append("rect").attr("height","27px").attr("width",H+"px").attr("rx",5).attr("ry",5).attr("id","serviceAreasToggle").attr("class","".concat(!0===L?"mapToggle mapToggled":"mapToggle"," ").concat(C)).attr("transform","translate(".concat(!0===L?tt:tt+H+j,",").concat($,")")),nt.append("text").text("Service Areas").attr("id","serviceAreasToggleText").attr("class","".concat(!0===L?"toggleText mapToggledText":"toggleText"," ").concat(C)).attr("transform","translate(".concat(!0===L?tt+75:tt+H+j+75,",").concat(z,")")),at.append("g").attr("class","toggle").attr("id","statesToggleG").on("mouseover",function(){d3.select("#statesToggle").classed("toggleHovered",!0)}).on("mouseout",function(){d3.select("#statesToggle").classed("toggleHovered",!1)}));ot.append("rect").attr("height","27px").attr("width",H+"px").attr("rx",5).attr("ry",5).attr("id","statesToggle").attr("class","".concat(!1===L?"mapToggle mapToggled":"mapToggle"," ").concat(C)).attr("transform","translate(".concat(!1===L?tt:tt+H+j,",").concat($,")")),ot.append("text").text("States & Territories").attr("id","statesToggleText").attr("class","".concat(!1===L?"toggleText mapToggledText":"toggleText"," ").concat(C)).attr("transform","translate(".concat(!1===L?tt+75:tt+H+j+75,",").concat(z,")"));"style2"===C&&(rt=at.append("rect").attr("id","slidingBorder").attr("class",C).attr("height",6).attr("width",H).attr("transform","translate(".concat(tt,",").concat(et,")")));var st,lt="none";if(1==G){at.append("text").text(function(){return 745<P?"Map Data":"Data Layer"}).attr("class","menuBarText "+C).attr("transform","translate("+J+","+K+")"),(st=N.append("select").attr("id","dataSelect").attr("class","dropdown select-css").style("left",Y+"px").style("top",W+"px")).selectAll("option").data(Object.keys(config.data)).enter().append("option").text(function(t){return config.data[t].dropdownName}).attr("value",function(t){return t}),lt=document.getElementById("dataSelect").value;var it=at.append("g");it.append("text").attr("class","aboutDataLabel ".concat(C).concat(P<830?" aboutLabelLower":"")).text("About this").style("text-anchor","".concat(830<P?"middle":"end")).attr("transform","translate(".concat(X,", ").concat(830<P?30:g+20,")")),it.append("text").attr("class","aboutDataLabel ".concat(C).concat(P<830?" aboutLabelLower":"")).text("data...").style("text-anchor","".concat(830<P?"middle":"start")).attr("transform","translate(".concat(Q,", ").concat(830<P?50:g+20,")"));it.on("mouseover",function(){d3.select("#aboutDataDiv").transition().duration(500).style("opacity",1)}).on("mouseout",function(){d3.select("#aboutDataDiv").transition().duration(500).style("opacity",0)});N.append("div").attr("id","aboutDataDiv").attr("class",C).style("position","absolute").style("width","400px").style("height","auto").style("top","".concat(830<P?g+15:g+30,"px")).style("right","".concat(830<P?15:30,"px")).html("")}var ct=V.append("g").attr("id","resetG").attr("transform","translate(28, ".concat(g+40,")")).style("opacity",0).style("pointer-events","none").on("mouseover",function(){kt()}).on("click",function(){p.transition().duration(750).call(y.transform,d3.zoomIdentity),gt=setTimeout(function(){d3.selectAll(".tooltip").style("display","none").style("opacity",0)},yt),clearTimeout(ut),d3.select(Ct).classed("selected",!1)});ct.append("rect").attr("width",130).attr("height",40).style("fill","#fff").attr("rx",10).attr("ry",10).attr("transform","translate(-22, -33)");ct.append("text").attr("text-anchor","middle").attr("class","fa resetZoomIcon").style("font-size","40px").text(""),ct.append("text").text("Reset pan").attr("id","resetZoomText1").attr("class","resetZoomText").attr("transform","translate(61,-17)"),ct.append("text").text("and zoom").attr("id","resetZoomText2").attr("class","resetZoomText").attr("transform","translate(61,-2)");var dt,pt=P<670?P/2-250:P-500;if(!0===G){(dt=V.append("g").attr("id","legendG").on("mouseover",function(){kt()})).append("rect").attr("id","legendBkgdRect").attr("width",500).attr("height",55).attr("rx",2).attr("ry",2).attr("transform","translate(".concat(pt-5,", ").concat(k-55-3,")"));dt.append("text").text("People per capita").attr("id","legendTitle").style("text-anchor","middle").attr("transform","translate(".concat(250+pt,", ").concat(k-40,")"));dt.selectAll(".legendItem").data([1,2,3,4,5]).enter().append("g").attr("class","legendItems").attr("id",function(t,e){return"legendItem".concat(String(e+1))}).attr("transform",function(t,e){return"translate(".concat(pt+100*e,", ").concat(k-15,")")}).each(function(t,e){d3.select(this).append("rect").attr("class","legendBackgroundRect").attr("width",100).attr("height",25).style("fill","#fff").style("opacity",0).attr("transform",function(t){return"translate(0, ".concat(-25,")")}),d3.select(this).append("rect").attr("class","legendRect").attr("width",90).attr("height",8).attr("id",function(t){return"legendRect".concat(String(t))}),d3.select(this).append("text").text(function(t){return t}).attr("class","legendValues").attr("id",function(t){return"legendValue".concat(String(t))}).attr("transform",function(t){return"translate(".concat(45,", ").concat(-5,")")}),d3.select(this).on("mouseover",function(t){d3.selectAll(".dataLayer:not(.group".concat(t,")")).classed("legendHoveredNo",!0)}).on("mouseout",function(t){d3.selectAll(".dataLayer:not(.group".concat(t,")")).classed("legendHoveredNo",!1)})})}var ut,gt,ft,mt,yt,ht=!0===I?150:220,vt={right:15,left:-(ht+15)};!0===D?(ft=600,mt=500,yt=599):!1===D&&(ft=400,mt=250,yt=99);var At,bt=15,Tt=25,xt=5,St=2*Tt+xt,wt=d3.scaleLinear().domain([0,.5]);V.on("mousemove",function(){At=d3.mouse(this)});var Gt=["#73d487","#30b096","#288993","#40607a","#453b52"],Lt=["#E56153","#FD9D62","#FFC479","#288993","#40607a"],Bt=d3.scaleThreshold();queue().defer(d3.json,"https://dev2015.lsc.gov/programprofilemap/budget-request-map/geo_data/service_areas_topojson_2020_01_16.json").defer(d3.json,"https://dev2015.lsc.gov/programprofilemap/budget-request-map/geo_data/mapAreasData_keyed.json").await(function(t,a,e){if(t)throw t;var r=topojson.feature(a,a.objects.service_areas).features;r.forEach(function(t){t.properties=Object.assign({},t.properties,e[t.properties.ServArea_1])});var n,o=[],s=!0,l=!1,i=void 0;try{for(var c,d=r[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;o.push(p.properties.ServArea_1)}}catch(t){l=!0,i=t}finally{try{s||null==d.return||d.return()}finally{if(l)throw i}}n=["AL","AK","AS","AZ","AR","CA","CO","CT","DE","DC","FL","GA","GU","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","MP","OH","OK","OR","PA","PR","RI","SC","SD","TN","TX","UT","VT","VI","VA","WA","WV","WI","WY"];var u=d3.entries(e).filter(function(t){return n.includes(t.key)}),g=d3.entries(e).filter(function(t){return!n.includes(t.key)}),f=[],m=!0,y=!1,h=void 0;try{for(var v,A=function(){var e=v.value,t=topojson.merge(a,a.objects.service_areas.geometries.filter(function(t){return t.properties.StAbbrev==e}));t.stAbbrev=e,f.push(t)},b=n[Symbol.iterator]();!(m=(v=b.next()).done);m=!0)A()}catch(t){y=!0,h=t}finally{try{m||null==b.return||b.return()}finally{if(y)throw h}}f.forEach(function(t){t.properties=e[t.stAbbrev]}),R.selectAll(".states").append("path").data(f).enter().append("path").attr("id",function(t){return t.stAbbrev}).attr("class","geo states dataLayer nonScaling "+C).attr("d",function(t){return F(t)}),O.selectAll("path").data(r).enter().append("path").attr("id",function(t){return t.properties.ServArea_1}).attr("class","geo serviceAreas dataLayer nonScaling "+C).attr("d",F),_.append("path").datum(topojson.mesh(a,a.objects.service_areas,function(t,e){return t.properties.StAbbrev!==e.properties.StAbbrev})).attr("class","geo stateInteriorMesh nonScaling").attr("d",F),!0===G&&Mt("SA"==E?g:u);It();var T,x=N.selectAll(".tooltip").data(o.concat(n)).enter().append("div").attr("class","tooltip".concat(!0===I?" tipTitleOnly":"")).attr("id",function(t){return t+"-tip"}).style("width",ht+"px").style("height","auto");x.append("p").attr("class","tipHeaderP "+C).append("span").attr("class","tipHeaderSpan").text(function(t){return e[t].name}),!1===D&&(d3.selectAll(".tooltip").style("pointer-events","none"),d3.selectAll(".geo, .territoryBox").style("cursor","pointer"));!1===I&&((T=x.append("div").attr("class","tipDataDiv").style("display","none")).append("p").attr("class","tipGraphHeader"),T.append("p").attr("class","tipGraphCategory").html(function(t){return"This area (".concat(t,")")}).style("padding-left",bt+"px"),T.append("svg").attr("class","tipGraphSvg").attr("height",St+"px").attr("width",ht+"px"),T.append("p").attr("class","tipGraphCategory tipNationalLabel").style("padding-left",bt+"px"),T.append("p").attr("class","tipGraphFootnote"),x.append("div").attr("class","tipContentDiv tipInfoSection").append("span").attr("class","tipLink").html(function(t){return n.includes(t)&&"org"==e[t].profileType?'<a href="'+e[t].link+"\">See the sole grantee's profile</a>":n.includes(t)?'<a href="'+e[t].link+'">See the aggregate state profile</a>':'<a href="'+e[t].link+"\">See this grantee's profile</a>"}));d3.selectAll(".states").on("click",function(t){!1===D&&window.open(t.properties.link,"_blank"),!0===M&&Dt(t,"ST")}).on("mouseover",function(t){Nt(t,"ST"),clearTimeout(ut),Vt(t,"ST")}).on("mouseout",function(t){Pt(t,"ST")}),d3.selectAll(".serviceAreas").on("click",function(t){!1===D&&window.open(t.properties.link,"_blank"),!0===M&&Dt(t,"SA")}).on("mouseover",function(t){Nt(t,"SA"),clearTimeout(ut),Vt(t,"SA")}).on("mouseout",function(t){Pt(t,"SA")}),d3.selectAll(".territoryBox").each(function(t){d3.select(this).on("click",function(t){!1===D&&window.open(e[t].link,"_blank")}).on("mouseover",function(t){"SA"==E?(Nt(d3.select("#".concat(t,"-1")).data()[0],"SA"),clearTimeout(ut),Vt(d3.select("#".concat(t,"-1")).data()[0],"SA")):(Nt(d3.select("#".concat(t)).data()[0],"ST"),clearTimeout(ut),Vt(d3.select("#".concat(t)).data()[0],"ST")),d3.select(this).classed("hoveredBox",!0)}).on("mouseout",function(t){"SA"==E?Pt(d3.select("#".concat(t,"-1")).data()[0],"SA"):Pt(d3.select("#".concat(t)).data()[0],"ST"),d3.select(this).classed("hoveredBox",!1)})});function S(){"style2"===C&&rt.transition().duration(1e3).ease(d3.easeCubicInOut).attr("transform","translate(".concat(!0===L?tt:tt+H+j,",").concat(et,")")),d3.selectAll(".serviceAreas").classed("inactiveLayer",!1),d3.selectAll(".states").classed("inactiveLayer",!0),d3.select("#serviceAreasToggle").classed("mapToggled",!0),d3.select("#statesToggle").classed("mapToggled",!1),d3.select("#serviceAreasToggleText").classed("mapToggledText",!0),d3.select("#statesToggleText").classed("mapToggledText",!1),E="SA",!0===G&&(Mt(g),It())}function w(){"style2"===C&&rt.transition().duration(1e3).ease(d3.easeCubicInOut).attr("transform","translate(".concat(!1===L?tt:tt+H+j,",").concat(et,")")),d3.selectAll(".states").classed("inactiveLayer",!1),d3.selectAll(".serviceAreas").classed("inactiveLayer",!0),d3.select("#serviceAreasToggle").classed("mapToggled",!1),d3.select("#statesToggle").classed("mapToggled",!0),d3.select("#serviceAreasToggleText").classed("mapToggledText",!1),d3.select("#statesToggleText").classed("mapToggledText",!0),E="ST",!0===G&&(Mt(u),It())}nt.on("click",function(){S()}),ot.on("click",function(){w()}),!0===L?S():!1===L&&w();!0===G&&st.on("change",function(t){lt=document.getElementById("dataSelect").value,Mt("SA"==E?g:u),It(!0),"none"!=lt?(d3.selectAll(".aboutDataLabel").style("pointer-events","auto").transition().duration(2e3).style("opacity",1),d3.select("#aboutDataDiv").html(config.data[lt].aboutDataHtml)):d3.selectAll(".aboutDataLabel").style("pointer-events","none").transition().duration(2e3).style("opacity",0).transition()});0<B?function(t){V.append("rect").attr("width",P).attr("height",k).attr("id","initOverlay").style("opacity",0).style("z-index",100).transition().delay(2100).style("pointer-events","none"),d3.select("#dataSelect").style("pointer-events","none").transition().delay(2100).style("pointer-events","auto"),1===B&&(d3.selectAll(".geo").attr("opacity",0),d3.selectAll(".geo").transition().duration(2e3).ease(d3.easeCubicInOut).style("opacity",1));2===B&&(d3.selectAll(".geo").attr("transform","translate(25,20)scale(0.90)"),d3.selectAll(".geo").transition().duration(2e3).ease(d3.easeCubicInOut).attr("transform","scale(1)"));10===B&&(d3.selectAll(".geo").style("opacity",0).attr("transform","scale(0.6)rotate(-180)"),d3.selectAll(".geo").transition().delay(200).duration(7e3).ease(d3.easeBounceOut).style("opacity",1).attr("transform","scale(1)"));11===B&&(d3.selectAll("".concat(!0===L?".serviceAreas":".states")).style("stroke-width",100),d3.selectAll("".concat(!0===L?".serviceAreas":".states")).transition().duration(3e3).ease(d3.easeCubicInOut).style("stroke-width",.5));var e=d3.timer(function(){e.stop(),d3.selectAll(".territoryBox").transition().duration(1e3).style("stroke-opacity",1),d3.select("#baseG").append("path").datum(topojson.merge(t,t.objects.service_areas.geometries)).attr("class","baseLayer").attr("d",F).attr("class","basePath").style("filter","url(#drop-shadow)").style("opacity",0).transition().duration(1e3).style("opacity",1),_t=!0},2e3)}(a):0===B&&d3.selectAll(".territoryBox").style("stroke-opacity",1)});var Ct="AK";function Dt(t,e){var a;d3.select(Ct).classed("selected",!1),"ST"==e?a="#".concat(t.stAbbrev):"SA"==e&&(a="#".concat(t.properties.ServArea_1)),Ct=a,d3.select(Ct).classed("selected",!0);var r=F.bounds(t),n=r[1][0]-r[0][0],o=r[1][1]-r[0][1],s=(r[0][0]+r[1][0])/2,l=(r[0][1]+r[1][1])/2,i=Math.max(1,Math.min(8,.9/Math.max(n/P,o/k))),c=[P/2-i*s,k/2-i*l];p.transition().duration(750).call(y.transform,d3.zoomIdentity.translate(c[0],c[1]).scale(i))}function Mt(t){if("none"==lt)return d3.select("#legendTitle").transition().duration(1500).delay(0).style("opacity",0),d3.select("#legendBkgdRect").style("pointer-events","none").transition().duration(1500).delay(0).style("opacity",0),void d3.selectAll(".legendItems").style("pointer-events","none").transition().duration(1e3).delay(function(t,e){return 100*(d3.selectAll(".legendItems").size()+2-e)}).style("opacity",0);var a;if(!0===G){a=1==config.data[lt].diverging?Lt:Gt,Bt.range(a).domain(config.data[lt].colorThresholds[E]),d3.selectAll(".legendRect").data(a).style("fill",function(t,e){return a[e]});var e,r=d3.format(config.data[lt].format);e="percent"==config.data[lt].type?.01:1,d3.select("#legendValue1").text("< ".concat(r(config.data[lt].colorThresholds[E][0]))),d3.select("#legendValue2").text("".concat(r(config.data[lt].colorThresholds[E][0])," to ").concat(r(config.data[lt].colorThresholds[E][1]-e))),d3.select("#legendValue3").text("".concat(r(config.data[lt].colorThresholds[E][1])," to ").concat(r(config.data[lt].colorThresholds[E][2]-e))),d3.select("#legendValue4").text("".concat(r(config.data[lt].colorThresholds[E][2])," to ").concat(r(config.data[lt].colorThresholds[E][3]-e))),d3.select("#legendValue5").text("".concat(r(config.data[lt].colorThresholds[E][3])," +")),d3.select("#legendTitle").text(config.data[lt].legendName),d3.selectAll(".legendItems").style("pointer-events","auto").transition().duration(1e3).delay(function(t,e){return 300+100*e}).style("opacity",1),d3.select("#legendTitle").transition().duration(1e3).delay(500).style("opacity",1),d3.select("#legendBkgdRect").style("pointer-events","auto").transition().duration(1e3).delay(500).style("opacity",.75),"SA"==E?d3.selectAll(".geo.serviceAreas").attr("class",function(t){return"geo serviceAreas dataLayer nonScaling group".concat(a.indexOf(Bt(t.properties[lt]))+1)}):d3.selectAll(".geo.states").attr("class",function(t){return"geo states dataLayer nonScaling group".concat(a.indexOf(Bt(t.properties[lt]))+1)});var n,o=-99999999,s=999999999;if(null!=config.data[lt].domainMaxForTooltip)o=config.data[lt].domainMaxForTooltip;else{var l=!0,i=!1,c=void 0;try{for(var d,p=t[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var u=d.value;u.value[lt]>o&&(o=u.value[lt])}}catch(t){i=!0,c=t}finally{try{l||null==p.return||p.return()}finally{if(i)throw c}}}if(null!=config.data[lt].domainMinForTooltip)s=config.data[lt].domainMinForTooltip;else{var g=!0,f=!1,m=void 0;try{for(var y,h=t[Symbol.iterator]();!(g=(y=h.next()).done);g=!0){var v=y.value;v.value[lt]<s&&(s=v.value[lt])}}catch(t){f=!0,m=t}finally{try{g||null==h.return||h.return()}finally{if(f)throw m}}}1==config.data[lt].diverging?(n=Math.max(Math.abs(s),Math.abs(o)),wt.rangeRound([0,.7*ht]).domain([-n,n])):wt.rangeRound([0,.7*ht]).domain([s,o])}}function It(t){var e=0;e=1==(0<arguments.length&&void 0!==t&&t)?500:0,"none"!=lt?"SA"==E?d3.selectAll(".geo.serviceAreas").transition().duration(e).style("fill",function(t){return Bt(t.properties[lt])}):d3.selectAll(".geo.states").transition().duration(e).style("fill",function(t){return Bt(t.properties[lt])}):d3.selectAll(".geo.serviceAreas, .geo.states").transition().duration(e).style("fill",config.colors.mapDefault[C])}function Nt(t,e){var a;"ST"==e?a="#"+t.stAbbrev:"SA"==e&&(a="#"+t.properties.ServArea_1),d3.select(a).classed("hovered",!0),!0===c&&("#MP-1"==a?d3.select("#GU-1").classed("hovered",!0):"#MP"==a&&d3.select("#GU").classed("hovered",!0))}function Pt(t,e){var a;"ST"==e?a=".states":"SA"==e&&(a=".serviceAreas"),d3.selectAll(a).classed("hovered",!1)}function kt(){gt=setTimeout(function(){d3.selectAll(".tooltip").style("display","none").style("opacity",0)},yt),clearTimeout(ut)}function Vt(t,e){var a,r;"ST"==e?a="#"+t.stAbbrev:"SA"==e&&(a="#"+t.properties.ServArea_1),"ST"==e?r=t.stAbbrev+"-tip":"SA"==e&&(r=t.properties.ServArea_1+"-tip");var n,o="#"+r,s=d3.select(o);if(!0===G)if("none"!=lt){s.select(".tipGraphHeader").html(config.data[lt].tooltipName),s.select(".tipNationalLabel").html("National ".concat(null==config.data[lt].nationalValueType?"":config.data[lt].nationalValueType)),s.selectAll(".tipDataDiv").style("display","block"),"data_pctOfPopEligible"==lt?(s.select(".tipGraphFootnote").style("display","block").html("*"+d3.format(",")(t.properties.data_popEligible)+" people"),s.select(".tipNationalLabel").style("margin-bottom",0)):(s.select(".tipGraphFootnote").style("display","none"),s.select(".tipNationalLabel").style("margin-bottom","10px"));var l,i=Bt(t.properties[lt]),c=Math.abs(wt(0)-wt(t.properties[lt])),d=Math.abs(wt(0)-wt(config.data[lt].nationalValue[E]));s.selectAll(".tipGraphItems").remove(),s.select("svg").append("rect").attr("class","tipGraphBar1 tipGraphItems").attr("width",0).attr("height",Tt).style("fill",i).attr("transform","translate(".concat(bt+wt(0),", 0)")),s.select("svg").append("rect").attr("class","tipGraphBar2 tipGraphItems").attr("width",0).attr("height",Tt).style("fill","#b4b4b4").attr("transform","translate(".concat(bt+wt(0),", ").concat(xt+Tt,")")),l="data_pctOfPopEligible"==lt?"*":"",s.select("svg").append("text").text(d3.format(config.data[lt].format)(t.properties[lt])+l).attr("class","tipGraphValue1 tipGraphItems tipGraphValues").style("fill",i).style("font-weight","bold"),s.select("svg").append("text").text(d3.format(config.data[lt].format)(config.data[lt].nationalValue[E])).attr("class","tipGraphValue2 tipGraphItems tipGraphValues").style("fill","#b4b4b4").style("font-weight","bold"),s.select("rect.tipGraphBar1").transition().delay(ft).duration(1500).attr("width",c).attr("transform","translate(".concat(t.properties[lt]<0?bt+wt(0)-c:bt+wt(0),", 0)")),s.select("rect.tipGraphBar2").transition().delay(ft).duration(1500).attr("width",d).attr("transform","translate(".concat(config.data[lt].nationalValue[E]<0?bt+wt(0)-d:bt+wt(0),", ").concat(xt+Tt,")")),s.select("text.tipGraphValue1").attr("transform","translate(".concat(bt+wt(0)+5,", ").concat(.7*Tt,")")).transition().delay(ft).duration(1500).attr("transform","translate(".concat(t.properties[lt]<0?bt+wt(0)+5:bt+wt(0)+5+c,", ").concat(.7*Tt,")")),s.select("text.tipGraphValue2").attr("transform","translate(".concat(bt+wt(0)+5,", ").concat(xt+1.7*Tt,")")).transition().delay(ft).duration(1500).attr("transform","translate(".concat(config.data[lt].nationalValue[E]<0?bt+wt(0)+5:bt+wt(0)+5+d,", ").concat(xt+1.7*Tt,")"))}else s.selectAll(".tipDataDiv").style("display","none");else s.selectAll(".tipDataDiv").style("display","none");var p=(n="SA"==E?F.bounds(t.geometry):F.bounds(t))[1][1]-n[0][1];gt=setTimeout(function(){d3.selectAll(".tooltip").style("display","none").style("opacity",0)},yt),ut=setTimeout(function(){s.style("display","block");var t=At[0],e=At[1];t<P/2?s.style("left",t+vt.right+"px"):s.style("left",t+vt.left+"px");var a=s.node().getBoundingClientRect().height;!0===u&&(e<g+(k-g)/3?s.style("top","".concat(e+.05*a,"px")):e<g+(k-g)/3*2?s.style("top","".concat(e-a/4,"px")):s.style("top","".concat(e-.8*a,"px"))),!1===u&&(t<P/2?s.style("left","".concat(n[1][0]+5,"px")):s.style("left","".concat(n[0][0]-5-ht,"px")),e<g+(k-g)/3?s.style("top","".concat(g+n[0][1]+.1*a,"px")):e<g+(k-g)/3*2?s.style("top","".concat(g+n[0][1]+p/2-a/3,"px")):s.style("top","".concat(g+n[0][1]-.8*a,"px"))),s.transition().duration(mt).style("opacity",1)},ft),s.on("mouseover",function(){clearTimeout(ut),clearTimeout(gt),d3.select(a).classed("hovered",!0)}).on("mouseout",function(){d3.selectAll("path").classed("hovered",!1),kt()})}function kt(){gt=setTimeout(function(){d3.selectAll(".tooltip").style("display","none").style("opacity",0)},yt),clearTimeout(ut)}f.on("mouseover",function(){kt()}),at.on("mouseover",function(){kt()})}var e,_t=!0,a=document.getElementById("map").offsetWidth;function r(){var t=document.getElementById("map").offsetWidth;t!=a&&(a=t,n())}function n(){600<document.getElementById("map").offsetWidth&1==_t?(d3.select("#map").selectAll("*").remove(),t(_t=!1,!1,1,!1,2,!1,!0,!1,!0)):document.getElementById("map").offsetWidth<=600&&d3.select("#map").selectAll("*").remove()}window.onresize=function(){clearTimeout(e),e=setTimeout(r,200)},n()}();